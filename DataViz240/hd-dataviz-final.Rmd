---
title: "Data Viz: Final Project"
author: "Halina Do-Linh"
date: "3/8/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(tidycensus)
library(tmap)
library(sf)
```

```{r}
# load data
data_combined_2018 <- read.csv("../../../data_clean/2018_joined_data.csv")
```


```{r}
# set up data
data_combined_2018_clean <- 
  data_combined_2018 %>% 
  group_by(agency, park) %>% 
  summarize(median_median_income = median(median_income, na.rm = TRUE),
            mean_median_income = mean(median_income, na.rm = TRUE),
            max_median_income = max(median_income, na.rm = TRUE),
            min_median_income = min(median_income, na.rm = TRUE),
            facility_latitude = mean(facility_latitude),
            facility_longitude = mean(facility_longitude),
            count = n()) %>% 
  st_as_sf(coords = c("facility_longitude","facility_latitude")) # lat lon columns are removed and values are moved into geometry column
  
```

```{r}
# pull in acs CA county data
zip_geometries_ca <- get_acs(geography = "county", year = 2018, geometry = TRUE, 
                             state = "California",
                             summary_var = "B01001_001",
                             variables = c(male = "B01001_002")) %>% 
  select(NAME, geometry)
  
zip_geometries_ca_clean <- zip_geometries_ca %>% 
  mutate(county = str_extract(NAME, "(\\w)([:punct:])"))
  # select(zip_code, geometry)

```

# Map

```{r}
tmap_mode("view")
tm_shape(zip_geometries_ca) +
  tm_polygons() +
tm_shape(data_combined_2018_clean) +
  tm_dots("count")
  
  
  # tm_shape(shapefile_with_MNO_data) + 
  # tm_dots("MNO_variable")
  
  
  
  # 
  # tm_fill(col = "number_reservations",
  #         palette = "PuRd",
  #         style = "jenks",
  #         n = 10)
```

