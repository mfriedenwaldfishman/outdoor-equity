---
title: "Working on functions"
author: "Clarissa"
date: "3/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(sf)
library(tidycensus)
library(patchwork)
library(scales)
library(tmap)
library(vroom)

options(scipen = 999)
```


# Read in joined data

```{r}
# read in joined data
data_ridb_acs_2018 <- vroom(file = "../../../../data_clean/2018_joined_data.csv",
                            delim = ",")
```





```{r}
test <- 
  data_ridb_acs_2018 %>% 
  select(agency, regional_area, park, facility_latitude, facility_longitude,
         total_paid, number_of_people, length_of_stay, booking_window, 
         daily_cost_per_visitor, asian, black, hispanic_latinx, multiracial, 
         native_american, other, pacific_islander, white, college, hs_GED_or_below, 
         master_or_above, some_college, median_income, no_vehicle) %>% 
  #filter(daily_cost_per_visitor != "Inf") %>% #drop 48 rows with "Inf" for cost/visitor/day
  pivot_longer(cols = c(facility_latitude, facility_longitude,
                        total_paid, number_of_people, length_of_stay, booking_window, 
                        daily_cost_per_visitor, asian, black, hispanic_latinx, 
                        multiracial, native_american, other, pacific_islander, 
                        white, college, hs_GED_or_below, master_or_above, 
                        some_college, median_income, no_vehicle), 
               names_to = "acs_variable",
               values_to = "acs_value") %>% 
  group_by(agency, regional_area, park, acs_variable) %>% 
  summarize(median = median(acs_value, na.rm = TRUE),
            mean = mean(acs_value, na.rm = TRUE),
            count = n()) %>% 
  pivot_wider(names_from = acs_variable, 
              values_from = c(median, mean)) %>% 
  select(-c(median_facility_latitude, median_facility_longitude))
```






